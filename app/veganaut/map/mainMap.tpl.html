<div>
    <!--
        The top-box bar is currently shown only for the embedded view.
        It will eventually get a redesign.
        TODO: Once the redesign is done, adapt the top-box or use the <vg-category-selector>
    -->
    <div class="top-box top-box--full-width container main-container"
     ng-if="mainMapVm.legacyGlobals.isEmbedded"
     ng-hide="mainMapVm.locationSet.active">
        <div class="top-box--full-width__border-offset">
            <div class="btn-group--top-box">
                <div>
                    <a type="button" class="btn-logo btn btn-default btn-default--transparent"
                     ng-click="mainMapVm.legacyGlobals.goToView('/')">
                        <ng-include src="'img/logo/veganaut.svg'" class="logo logo--top-box"></ng-include>
                    </a>
                </div>
                <button type="button" class="btn-show-product-list btn btn-default btn-default--transparent"
                 title="{{ 'action.showProductList.description' | translate }}"
                 ng-click="mainMapVm.legacyGlobals.goToView('/products/')">
                    <span class="glyphicon glyphicon-leaf"></span><br/>
                    <span class="small">
                        {{ 'action.showProductList.name' | translate }}
                    </span>
                </button>
                <button type="button" class="btn-location-list btn btn-default btn-default--transparent"
                 ng-click="mainMapVm.legacyGlobals.goToView('/locations/')"
                 title="{{ 'action.showList.description' | translate }}">
                    <span class="glyphicon glyphicon-th-list"></span><br/>
                    <span class="small">{{ 'action.showList.name' | translate }}</span>
                </button>
                <vg-filter-button
                 ng-if="!mainMapVm.legacyGlobals.isEmbedded">
                </vg-filter-button>
                <button type="button" class="btn-register btn btn-primary"
                 ng-if="!mainMapVm.legacyGlobals.isLoggedIn()"
                 ng-click="mainMapVm.legacyGlobals.goToView('/register') | track:'linkToRegister':'linkToRegister.mainMap'"
                 title="{{ 'action.register.description' | translate }}">
                    <span class="glyphicon glyphicon-heart"></span><br/>
                    <span class="small">{{ 'action.register.name' | translate }}</span>
                </button>
                <button type="button" class="create-location btn btn-primary"
                 ng-if="mainMapVm.legacyGlobals.isLoggedIn()"
                 ng-click="mainMapVm.startCreateLocation()"
                 title="{{ 'action.createLocation.description' | translate }}">
                    <span class="glyphicon glyphicon-plus-sign"></span><br/>
                    <span class="small">{{ 'action.createLocation.name' | translate }}</span>
                </button>
            </div>
        </div>
    </div>

    <div class="top-box container main-container"
     ng-if="mainMapVm.locationSet.active && !mainMapVm.locationSet.isCreatingLocation()">
        <vg-location-pane
         vg-location="mainMapVm.locationSet.active"
         vg-view-category="mainMapVm.mapCategory"
         vg-on-close="mainMapVm.locationSet.activate()">
        </vg-location-pane>
    </div>

    <vg-overlay ng-if="mainMapVm.locationSet.isCreatingLocation()">
        <vg-create-location-form
         vg-map="mainMapVm.map"
         vg-create-location="mainMapVm.locationSet.createLocation"
         vg-on-abort="mainMapVm.locationSet.abortCreateLocation()"
         vg-on-submit="mainMapVm.locationSet.submitCreateLocation()">
        </vg-create-location-form>
    </vg-overlay>

    <!--
        Currently, the category selector is hidden in the embedded view.
        TODO: Once the embedded view get redesigned, it is possible it will need to be shown.
    -->
    <vg-category-selector ng-if="!mainMapVm.legacyGlobals.isEmbedded"></vg-category-selector>

    <div id="mainMap" class="main-map"
     ng-class="[(mainMapVm.locationSet.createLocation.isPlacingLocation() ? 'map--placing-location' : ''),
     ('main-map--' + mainMapVm.mapCategory)]">
    </div>

    <vg-map-markers
     ng-if="mainMapVm.map"
     vg-location-items="mainMapVm.locationSet.allLocationItems"
     vg-on-click="mainMapVm.onLocationClick(locationItem)"
     vg-map="mainMapVm.map">
    </vg-map-markers>

    <vg-geolocate-button
     ng-if="mainMapVm.map"
     vg-map="mainMapVm.map">
    </vg-geolocate-button>

    <div class="vg-map-footer">
        <div class="vg-map-footer-content">
            <div class="vg-map-footer-text">
                <div class="vg-map-footer-text__locations-count" ng-show="mainMapVm.mapCategory">
                    {{ 'lists.' + mainMapVm.mapCategory + '.title' |
                        translate: {count: mainMapVm.locationSet.totalLocations} }}
                </div>
                <div class="vg-map-footer-text__radius">
                    {{ 'map.mapSectionDescription' | translate }}
                </div>
            </div>
            <button type="button"
             class="btn btn-primary btn-small"
             ng-if="mainMapVm.isCreateLocationButtonVisible()"
             ng-click="mainMapVm.startCreateLocation()">
                <vg-icon vg-name="'add-location'" class="btn__icon"></vg-icon>
                {{ 'action.createLocation.name' | translate }}
            </button>
        </div>
    </div>
</div>
